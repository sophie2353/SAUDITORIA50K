<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>SAUDITORIA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background-color: #6a0dad;
      color: white;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      font-weight: bold;
      font-size: 20px;
    }
    .hero {
      background: linear-gradient(135deg, #6a0dad, #9b30ff);
      padding: 80px 20px;
      text-align: center;
    }
    .hero h1 {
      font-size: 2.5em;
      margin-bottom: 20px;
    }
    .hero p {
      font-size: 1.2em;
      margin-bottom: 30px;
    }
    button {
      background-color: white;
      color: #6a0dad;
      border: none;
      padding: 12px 24px;
      margin: 15px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 6px;
      font-weight: bold;
      transition: transform 0.2s ease;
    }
    button:hover {
      transform: scale(1.05);
      background-color: #ddd;
    }
    .service {
      background: rgba(255,255,255,0.1);
      padding: 40px;
      border-radius: 12px;
      margin: 40px auto;
      max-width: 700px;
      text-align: center;
    }
    input[type="file"] {
      margin: 20px auto;
      display: block;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table th, table td {
      padding: 12px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    table tr:nth-child(even) {
      background: rgba(255,255,255,0.05);
    }
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        text-align: center;
        font-size: 18px;
      }
      .hero h1 { font-size: 1.8em; }
      .hero p { font-size: 1em; }
      button { width: 90%; max-width: 300px; }
    }
  </style>
</head>
<body>
  <header>
    <div>SAUDITORIA</div>
    <div>SOCREDI</div>
  </header>

  <section class="hero">
    <h1>Corrige las facturas de tu negocio en pocos minutos</h1>
    <p>Miles de dÃ³lares ahorrados en una correcciÃ³n.<br>
       Accede a <strong>SAUDITORIA</strong> con solo un pago.</p>
    <button onclick="openKontigoPayment({
      slug: 'sauditoria',
      amount: 2000,
      redirectUrl: 'https://tuusuario.github.io/sauditoria-web/'
    })">
      Pagar Servicio
    </button>
  </section>

  <section class="service">
    <h2>Sube tu archivo para corregir</h2>
    <input type="file" id="archivo" />
    <button onclick="enviarFacturas()">Corregir Facturas</button>

    <h2>Resultado</h2>
    <table id="tablaResultados"></table>

    <button onclick="descargarCSV()">ðŸ’¾ Descargar CSV</button>
  </section>

  <script>
    function openKontigoPayment({ slug, amount, redirectUrl }) {
      const url = `https://app.kontigo.lat/pay/${slug}?amount=${amount}&redirect_url=${encodeURIComponent(redirectUrl)}`;
      window.location.href = url;
    }

    async function enviarFacturas() {
      const response = await fetch("TU_ENDPOINT_DE_APPSMITH_ANALIZAR", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ facturas: [
          { Producto: "CafÃ©", Precio: 10, IVA: 1.6, Total: 11.6, Fecha: "2025-01-10" },
          { Producto: "Pan", Precio: 5, IVA: 0.8, Total: 5.8, Fecha: "2025-01-10" }
        ]})
      });
      const data = await response.json();
      mostrarTabla(data);
    }

    function mostrarTabla(data) {
      const facturas = data.facturasCorregidas || [];
      let html = "<tr><th>Producto</th><th>Precio</th><th>IVA</th><th>Total</th><th>% IVA</th></tr>";
      facturas.forEach(f => {
        html += `<tr>
          <td>${f.Producto}</td>
          <td>${f.Precio}</td>
          <td>${f.IVA}</td>
          <td>${f.Total}</td>
          <td>${f.PorcentajeIVA}</td>
        </tr>`;
      });
      document.getElementById("tablaResultados").innerHTML = html;
    }

    async function descargarCSV() {
      const response = await fetch("TU_ENDPOINT_DE_APPSMITH_EXPORTARCSV", { method: "POST" });
      const csv = await response.text();

      const blob = new Blob([csv], { type: "text/csv" });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "facturas_corregidas.csv";
      a.click();
      window.URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
